<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Interactive graph – NBA Team Stats Visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./conclusion.html" rel="next">
<link href="./results.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./d3graph.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">NBA Team Stats Visualization</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/yandongxiang/NBA_team_stats" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d3graph.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style>
  * {
    font-family: sans-serif;
  }
</style>
<div id="plot">
<h2 class="anchored">
Team Win Rate Correlation Analysis
</h2>
<label for="selector">X Variable: </label> <select id="selector"> <option value="3P%">3-Point Accuracy</option> <option value="FG%">Field Goals Accuracy</option> <option value="PTS">Points</option> <option value="REB">Rebounds</option> <option value="TOV">Turnovers</option> </select> <svg id="teamswinrate" width="800" height="500"></svg>
<p>
We plotted this graph in a way that we can observe the win rate of teams against seasonal average 3-point accuracy, field goal accuracy, points, rebounds, and turnovers. On the other hand, we also enabled a mouse-over effect on data points so that we can check whether basketball teams met the stereotypes.
</p>
<p>
While average 3-point accuracy, field goal accuracy, points, and rebounds positively correlate with the win rate, average turnovers negatively correlate with the win rate. Interestingly, we can observe that 3-point accuracy seems to have the strongest correlation with the win rate of basketball teams. We can also observe from the plot that there seems to be a cutoff at 36.5% in 3-point accuracy. The majority of the teams with a win rate greater than 50% have a 3-point accuracy above 36.5%, with the only exceptions being Magic and 76ers. All of the teams with a win rate equal to or below 50% have a 3-point accuracy below 36.5%. Then it comes to me: how come the Golden State Warriors, the team with the best 3-point shooter, ranked relatively low in terms of win rate? When hovering over the data, we can see that the Warriors actually have a lower 3-point accuracy on average as a team. Then it makes sense that Warriors have a much lower win rate compared to Celtics.
</p>
<h2 class="anchored">
Player Shooting Analysis
</h2>
<label for="players-selector">Analyzed Variable: </label> <select id="players-selector"> <option value="3PA">3-Point</option> <option value="FGA">Field Goals</option> </select> <svg id="players-scatterplot" width="800" height="500"></svg>
<div id="scatterplot">
<p>
We plotted this graph in a way that we can observe the correlation between field goal accuracy and field goal attempts and the correlation between 3-point accuracy and 3-point attempts. On the other hand, we can hover our mouse over the plot to see which player the data point represents.
</p>
<p>
We can see that for players with high 3-point and field goal attempts, they don’t necessarily have higher 3-point and field goal accuracy compared to other players. Moreover, we cannot see much of a positive correlation between the attempted shots and the shooting accuracy of players. This leads us to a question: do some players gain more points and make more shots only because they are more risk-taking? That is a question that we cannot answer with existing data but is interesting to ponder and experiment about. Another observation we have is that players with low accuracy tend to attempt fewer shots. This is intuitive, if a player has a poor shot, they will be more reluctant to take the shot.
</p>
<h2 class="anchored">
Relationship Between Top 2 Fantasy Points and Wins
</h2>
<svg width="800" height="500"></svg>
<p>
</p><p>In this graph, I first found two players of each team who have the top 2 fantastic points in their team, and I want to see the relationship between the average fantasy points of top 2 players in each team and the num of winning games.</p>
It showed that generally, these two stats are positive correlated. This kind of makes sense since if their core players are better, their team tends to be better. However, we know that basketball is team sports. so there are some teams that has high fantasy points of their core players, but other player may not have a big role, which cannot make team win.
<p></p>
<h2 class="anchored">
NBA Regular vs Playoff Comparison
</h2>
<label for="selector2">Metric:</label> <select id="selector2"></select> <svg id="comparison-chart" width="800" height="500"></svg>
<p>
</p><p>Feature with significant difference:</p>
<p>Double Double (DD2), Triple Double (TD3): Double Double means a player have and two of these stats points, rebounds, assists, and steals that over 10 in one game is a double double. Triple double means player should have any three of the stats over 10 in one game. We can see these two features show how all-around a player is. In the graph we can clearly see that the average of DD2 and TD3 is significantly decreased. This show that it is hard for player to achieve DD2 or TD3 in playoffs, which indicates the game in playoffs is more intense.</p>
<p>Features with slight difference:</p>
<p>Turnovers (TOV): Players tend to have slightly higher turnovers during the Playoffs compared to the Regular Season. This is may because in playoffs, players have increased defensive pressure and the game is more intense than regular season.</p>
<p>Points (PTS), Fantastic Point (FP): Average scoring is slightly lower during the Playoffs, which also shows players have increased defensive pressure and the game is more intense than regular season. Fantastic point is an indicator of how positive effect does a play have on the court.</p>
<p>Shooting Performance (FGA, FGM, FG., X3P., X3PA, X3PM): Regular Season shows higher field goal percentage (FG.) and three-point percentage (X3P.). However, the Playoffs we can see an decrease in shot attempts (FGA) and three-point attempts (X3PA) and the shooting percentage is also lower. This indicates increased defensive pressure in the Playoffs.</p>
<p>Assists (AST), Rebounds (REB), Blocks (BLK), and Steals (STL): These features show a slight decrease from Regular to Playoff seasons, also give an insight that players the game is more intense.</p>
Free Throw Percentage (FT.): Regular Season shows higher Free Throw Percentage (FT.). Free throws really require precision, focus, and mental stability under pressure.Therefore, this difference is more intuitive to show that playoffs game is more intense and players are under more stressed and are more tired.
<p></p>
<div id="tooltip" class="tooltip">

</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="scripts/myscript.js"></script>
<script>
  const teamsDataPath = "https://raw.githubusercontent.com/yandongxiang/NBA_team_stats/main/data/NBA_team_2023-2024csv.csv";
  
  d3.csv(teamsDataPath)
    .then(data => {
      console.log("Loaded Data:", data);
  
      data.forEach(d => {
        d["Team"] = d["Team"];
        d["WIN%"] = +d["WIN%"]*100;
        d["3P%"] = +d["3P%"];
        d["FG%"] = +d["FG%"];
        d["PTS"] = +d["PTS"];
        d["REB"] = +d["REB"];
        d["TOV"] = +d["TOV"];
      });
  
      const svg = d3.select("#teamswinrate"),
            margin = { top: 20, right: 30, bottom: 50, left: 60 },
            width = svg.attr("width") - margin.left - margin.right,
            height = svg.attr("height") - margin.top - margin.bottom;
  
      const chart = svg.append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);
  
      const xLabel = svg.append("text")
        .attr("id", "x-axis-label")
        .attr("transform", `translate(${width / 2 + margin.left},${height + margin.top + 40})`)
        .style("text-anchor", "middle")
        .text("3P%");
  
      svg.append("text")
        .attr("transform", `rotate(-90)`)
        .attr("x", -(height / 2) - margin.top)
        .attr("y", 15)
        .style("text-anchor", "middle")
        .text("Win Rate");
  
      const xScale = d3.scaleLinear().range([0, width]);
      const yScale = d3.scaleLinear().range([height, 0]);
  
      chart.append("g").attr("class", "x-axis").attr("transform", `translate(0,${height})`);
      chart.append("g").attr("class", "y-axis");
  
      const tooltip = d3.select("#plot")
        .append("div")
        .style("position", "absolute")
        .style("background-color", "white")
        .style("border", "1px solid #ccc")
        .style("padding", "5px")
        .style("border-radius", "5px")
        .style("box-shadow", "0px 0px 5px rgba(0,0,0,0.2)")
        .style("visibility", "hidden");
  
      const updatePlot = (xVariable) => {
        xScale.domain(d3.extent(data, d => d[xVariable])).nice();
        yScale.domain([0, d3.max(data, d => d["WIN%"])]).nice();
  
        chart.select(".x-axis").call(d3.axisBottom(xScale));
        chart.select(".y-axis").call(d3.axisLeft(yScale));
  
        const circles = chart.selectAll("circle").data(data);
  
        circles.enter().append("circle")
          .attr("r", 5)
          .attr("fill", "steelblue")
          .merge(circles)
          .on("mouseover", (event, d) => {
            tooltip.style("visibility", "visible")
              .html(`<strong>${d["Team"]}</strong><br>${xVariable}: ${d[xVariable]}<br>Win%: ${d["WIN%"]}`)
              .style("left", `${event.pageX + 10}px`)
              .style("top", `${event.pageY + 10}px`);
          })
          .on("mousemove", (event) => {
            tooltip.style("left", `${event.pageX + 10}px`)
              .style("top", `${event.pageY + 10}px`);
          })
          .on("mouseout", () => {
            tooltip.style("visibility", "hidden");
          })
          .transition().duration(500)
          .attr("cx", d => xScale(d[xVariable]))
          .attr("cy", d => yScale(d["WIN%"]));
  
        circles.exit().remove();
  
        xLabel.text(xVariable);
      };
  
      d3.select("#selector").on("change", function() {
        updatePlot(this.value);
      });
  
      updatePlot("3P%");
    })
    
  const playersDataPath = "https://raw.githubusercontent.com/yandongxiang/NBA_team_stats/main/data/NBA_players_2023-2024csv.csv";
  
  d3.csv(playersDataPath)
    .then(data => {
      console.log("Loaded Player Data:", data);
  
      data.forEach(d => {
        d["Player"] = d["Player"];
        d["3PA"] = +d["3PA"];
        d["3P%"] = +d["3P%"];
        d["FGA"] = +d["FGA"];
        d["FG%"] = +d["FG%"];
      });
  
      const svg = d3.select("#players-scatterplot"),
            margin = { top: 20, right: 30, bottom: 50, left: 60 },
            width = svg.attr("width") - margin.left - margin.right,
            height = svg.attr("height") - margin.top - margin.bottom;
  
      const chart = svg.append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);
  
      const xLabel = svg.append("text")
        .attr("id", "x-axis-label")
        .attr("transform", `translate(${width / 2 + margin.left},${height + margin.top + 40})`)
        .style("text-anchor", "middle")
        .text("3PA (3-Point Attempts)");
  
      svg.append("text")
        .attr("transform", `rotate(-90)`)
        .attr("x", -(height / 2) - margin.top)
        .attr("y", 15)
        .style("text-anchor", "middle")
        .text("Shooting Accuracy");
  
      const xScale = d3.scaleLinear().range([0, width]);
      const yScale = d3.scaleLinear().range([height, 0]);
  
      chart.append("g").attr("class", "x-axis").attr("transform", `translate(0,${height})`);
      chart.append("g").attr("class", "y-axis");
  
      const tooltip = d3.select("#plot")
        .append("div")
        .style("position", "absolute")
        .style("background-color", "white")
        .style("border", "1px solid #ccc")
        .style("padding", "5px")
        .style("border-radius", "5px")
        .style("box-shadow", "0px 0px 5px rgba(0,0,0,0.2)")
        .style("visibility", "hidden");
  
      const updatePlot = (xVariable) => {
        const yVariable = xVariable === "3PA" ? "3P%" : "FG%";
  
        xScale.domain(d3.extent(data, d => d[xVariable])).nice();
        yScale.domain([0, d3.max(data, d => d[yVariable])]).nice();
  
        chart.select(".x-axis").call(d3.axisBottom(xScale));
        chart.select(".y-axis").call(d3.axisLeft(yScale));
  
        const circles = chart.selectAll("circle").data(data);
  
        circles.enter().append("circle")
          .attr("r", 4)
          .attr("opacity", 0.5)
          .attr("fill", "steelblue")
          .merge(circles)
          .on("mouseover", (event, d) => {
            tooltip.style("visibility", "visible")
              .html(`<strong>${d["Player"]}</strong><br>${xVariable}: ${d[xVariable]}<br>${yVariable}: ${d[yVariable]}`)
              .style("left", `${event.pageX + 10}px`)
              .style("top", `${event.pageY + 10}px`);
          })
          .on("mousemove", (event) => {
            tooltip.style("left", `${event.pageX + 10}px`)
              .style("top", `${event.pageY + 10}px`);
          })
          .on("mouseout", () => {
            tooltip.style("visibility", "hidden");
          })
          .transition().duration(500)
          .attr("cx", d => xScale(d[xVariable]))
          .attr("cy", d => yScale(d[yVariable]));
  
        circles.exit().remove();
  
        xLabel.text(xVariable === "3PA" ? "3-Point Attempts" : "Field Goal Attempts");
      };
  
      d3.select("#players-selector").on("change", function() {
        updatePlot(this.value);
      });
  
      updatePlot("3PA");
    })    

  const dataPath = "https://raw.githubusercontent.com/yandongxiang/NBA_team_stats/refs/heads/main/data/team_data_fp.csv";

  d3.csv(dataPath).then(data => {
    // 转换数据为数字类型
    data.forEach(d => {
      d.avg_fp_top2 = +d.avg_fp_top2;
      d.W = +d.W;
    });

    const svg = d3.select("#scatterplot svg"),
          margin = { top: 20, right: 30, bottom: 70, left: 70 },
          width = +svg.attr("width") - margin.left - margin.right,
          height = +svg.attr("height") - margin.top - margin.bottom;

    const chart = svg.append("g")
      .attr("transform", `translate(${margin.left},${margin.top})`);

    // 设置缩放比例，并添加缓冲区
    const xExtent = d3.extent(data, d => d.avg_fp_top2);
    const yExtent = d3.extent(data, d => d.W);

    const xScale = d3.scaleLinear()
      .domain([xExtent[0] - (xExtent[1] - xExtent[0]) * 0.1, xExtent[1] + (xExtent[1] - xExtent[0]) * 0.1]) // 添加 10% 缓冲区
      .range([0, width]);

    const yScale = d3.scaleLinear()
      .domain([yExtent[0] - (yExtent[1] - yExtent[0]) * 0.1, yExtent[1] + (yExtent[1] - yExtent[0]) * 0.1]) // 添加 10% 缓冲区
      .range([height, 0]);

    // 添加轴
    chart.append("g")
      .attr("transform", `translate(0,${height})`)
      .call(d3.axisBottom(xScale).ticks(10))
      .selectAll("text")
      .style("font-size", "14px");

    chart.append("g")
      .call(d3.axisLeft(yScale).ticks(10))
      .selectAll("text")
      .style("font-size", "14px");

    // 添加轴标签
    svg.append("text")
      .attr("transform", `translate(${width / 2 + margin.left},${height + margin.top + 50})`)
      .style("text-anchor", "middle")
      .style("font-size", "16px")
      .text("Average Fantasy Points (Top 2 Players)");

    svg.append("text")
      .attr("transform", "rotate(-90)")
      .attr("x", -(height / 2) - margin.top)
      .attr("y", 20)
      .style("text-anchor", "middle")
      .style("font-size", "16px")
      .text("Number of Wins");

    // 添加散点
    const tooltip = d3.select("#scatterplot")
      .append("div")
      .style("position", "absolute")
      .style("background-color", "white")
      .style("border", "1px solid #ccc")
      .style("padding", "5px")
      .style("border-radius", "5px")
      .style("box-shadow", "0px 0px 5px rgba(0,0,0,0.2)")
      .style("visibility", "hidden");

    chart.selectAll(".dot")
      .data(data)
      .enter().append("circle")
      .attr("class", "dot")
      .attr("cx", d => xScale(d.avg_fp_top2))
      .attr("cy", d => yScale(d.W))
      .attr("r", 5)
      .attr("fill", "blue")
      .attr("opacity", 0.7)
      .on("mouseover", (event, d) => {
        tooltip.style("visibility", "visible")
          .html(`<strong>${d.Team}</strong><br>Wins: ${d.W}<br>Avg FP: ${d.avg_fp_top2}`)
          .style("left", `${event.pageX + 10}px`)
          .style("top", `${event.pageY + 10}px`);
      })
      .on("mousemove", (event) => {
        tooltip.style("left", `${event.pageX + 10}px`)
          .style("top", `${event.pageY + 10}px`);
      })
      .on("mouseout", () => {
        tooltip.style("visibility", "hidden");
      });

    // 计算线性回归
    const xMean = d3.mean(data, d => d.avg_fp_top2);
    const yMean = d3.mean(data, d => d.W);
    const slope = d3.sum(data, d => (d.avg_fp_top2 - xMean) * (d.W - yMean)) /
                  d3.sum(data, d => Math.pow(d.avg_fp_top2 - xMean, 2));
    const intercept = yMean - slope * xMean;

    // 拟合曲线数据
    const xFit = d3.extent(data, d => d.avg_fp_top2);
    const yFit = xFit.map(x => slope * x + intercept);

    // 绘制拟合曲线
    chart.append("line")
      .attr("x1", xScale(xFit[0]))
      .attr("y1", yScale(yFit[0]))
      .attr("x2", xScale(xFit[1]))
      .attr("y2", yScale(yFit[1]))
      .attr("stroke", "red")
      .attr("stroke-width", 2);

  }).catch(error => {
    console.error("Error loading data:", error);
  });
  
  // CSV 文件路径
  const csvPath = "https://raw.githubusercontent.com/yandongxiang/NBA_team_stats/refs/heads/main/data/average_data.csv";

  // 定义变量的全称和简写
  const metricNames = {
    "Min": "Minutes Played (Min)",
    "PTS": "Points (PTS)",
    "FGM": "Field Goals Made (FGM)",
    "FGA": "Field Goals Attempted (FGA)",
    "FG.": "Field Goal Percentage (FG%)",
    "X3PM": "3-Point Field Goals Made (3PM)",
    "X3PA": "3-Point Field Goals Attempted (3PA)",
    "X3P.": "3-Point Field Goal Percentage (3P%)",
    "FTM": "Free Throws Made (FTM)",
    "FTA": "Free Throws Attempted (FTA)",
    "FT.": "Free Throw Percentage (FT%)",
    "OREB": "Offensive Rebounds (OREB)",
    "DREB": "Defensive Rebounds (DREB)",
    "REB": "Rebounds (REB)",
    "AST": "Assists (AST)",
    "TOV": "Turnovers (TOV)",
    "STL": "Steals (STL)",
    "BLK": "Blocks (BLK)",
    "PF": "Personal Fouls (PF)",
    "FP": "Fantasy Points (FP)",
    "DD2": "Double Doubles (DD2)",
    "TD3": "Triple Doubles (TD3)"
  };

  // 加载 CSV 数据
  d3.csv(csvPath).then(data => {
    // 格式化数据
    data.forEach(d => {
      d.value = +d.value; // 转换为数值类型
    });

    // 提取唯一的 Metric 列表
    const metrics = [...new Set(data.map(d => d.Metric))];

    // 填充下拉菜单
    const selector = d3.select("#selector2");
    selector.selectAll("option")
      .data(metrics)
      .enter()
      .append("option")
      .text(d => metricNames[d] || d) // 显示全称和简写
      .attr("value", d => d);

    // 绘制初始图表
    updateChart(metrics[0]);

    // 监听下拉框事件
    selector.on("change", function() {
      updateChart(this.value);
    });

    // 图表更新函数
    function updateChart(selectedMetric) {
      const filteredData = data.filter(d => d.Metric === selectedMetric);

      // 图表边距
      const margin = { top: 40, right: 20, bottom: 50, left: 50 };
      const width = 800 - margin.left - margin.right;
      const height = 500 - margin.top - margin.bottom;

      // 创建 SVG 容器
      const svg = d3.select("#comparison-chart")
        .attr("width", 800)
        .attr("height", 500);

      svg.selectAll("*").remove(); // 清空之前的图表内容

      const chart = svg.append("g")
        .attr("transform", `translate(${margin.left}, ${margin.top})`);

      // 定义 X 轴和 Y 轴比例尺
      const xScale = d3.scaleBand()
        .domain(filteredData.map(d => d.Stage))
        .range([0, width])
        .padding(0.2);

      const yScale = d3.scaleLinear()
        .domain([0, d3.max(filteredData, d => d.value)])
        .range([height, 0]);

      // 绘制 X 轴
      chart.append("g")
        .attr("transform", `translate(0, ${height})`)
        .call(d3.axisBottom(xScale))
        .selectAll("text")
        .style("text-anchor", "middle");

      // 绘制 Y 轴
      chart.append("g")
        .call(d3.axisLeft(yScale));

      // 绘制柱状图
      chart.selectAll(".bar")
        .data(filteredData)
        .enter()
        .append("rect")
        .attr("class", "bar")
        .attr("x", d => xScale(d.Stage))
        .attr("y", d => yScale(d.value))
        .attr("width", xScale.bandwidth())
        .attr("height", d => height - yScale(d.value))
        .attr("fill", d => d.Stage === "Regular" ? "skyblue" : "orange") // 初始化颜色
        .on("mouseover", function (event, d) {
          

          d3.select("#tooltip")
            .style("visibility", "visible")
            .html(`<strong>${d.Stage}</strong><br>Value: ${d.value.toFixed(2)}`);
        })
        .on("mousemove", event => {
          d3.select("#tooltip")
            .style("top", `${event.pageY + 10}px`)
            .style("left", `${event.pageX + 10}px`);
        })
        .on("mouseout", function (event, d) {
          d3.select(this) // 恢复柱子的初始颜色
            .attr("fill", d.Stage === "Regular" ? "skyblue" : "orange");

          d3.select("#tooltip").style("visibility", "hidden");
        });

      // 添加标题
      svg.append("text")
        .attr("x", width / 2 + margin.left)
        .attr("y", margin.top / 2)
        .attr("text-anchor", "middle")
        .attr("class", "chart-title")
        .text(metricNames[selectedMetric] || selectedMetric);
    }
  }).catch(error => {
    console.error("Error loading or processing data:", error);
  });
</script>


</div>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./results.html" class="pagination-link" aria-label="Results">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./conclusion.html" class="pagination-link" aria-label="Conclusion">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions"><ul><li><a href="https://github.com/yandongxiang/NBA_team_stats/edit/main/d3graph.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/yandongxiang/NBA_team_stats/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>